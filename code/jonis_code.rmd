---
title: "Jonis R Notebook"
output: html_document
---

The [R plugin](https://www.jetbrains.com/help/pycharm/r-plugin-support.html) for IntelliJ-based IDEs provides
handy capabilities to work with the [R Markdown](https://www.jetbrains.com/help/pycharm/r-markdown.html) files.
To [add](https://www.jetbrains.com/help/pycharm/r-markdown.html#add-code-chunk) a new R chunk,

```{r}
pacman::p_load(tidyverse, readxl, lubridate, RColorBrewer, ggthemes)
data <- read_csv("data.txt")

```

```{r}
# Transform the values in the date-column into a date format
#data$date <- as.Date( data$date, format = "%d.%m.%Y")

library(lubridate)
data$date <- parse_date_time(data$date, c("dmy"))
data$month <- parse_date_time(data$month, c("my"))
# Using functions provided by the `lubridate` -package, we transform the values in the month-columns into a date format:

data$weekday <- weekdays(data$date)

data$amount <- 1

#Using the `weekdays` -function we can add a column "weekday" that contains the day of the week corresponding to the date:
```

```{r}
data %>%
  ggplot(mapping = aes(x = month,
                       y = amount,
                        fill = weekday)) +
  labs(x = "month", y = "total amount") +
  geom_col() +
  theme_classic()
```


```{r}
#plot the amount of events per moth:
ggplot(data, aes(x=month, y=amount,fill=weekday)) +
  geom_bar(stat='identity') +
  xlab('Month') +
  ylab('Number of Events') +
  ggtitle('Number of Events Per Month')
```
```{r}
data %>%
  ggplot(mapping = aes(x = weekday,
                       y = amount,
                       fill = month)) +
  labs(x = "weekady", y = "total amount") +
  geom_col() +
  theme_classic()


library(ggplot2)

ggplot(data, aes(x = weekday, y = amount, fill = month)) +
  geom_bar(stat = "identity") +
    theme(axis.text.x = element_text(size = 8),
          axis.text.y = element_text(size = 8))  +
  scale_x_discrete(limits = c("Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag", "Sonntag")) +
  geom_hline(aes(yintercept = median(amount)), color = "red")


# library(ggplot2)
#
# ggplot(data, aes(x=weekday, y=amount, fill=month)) +
#   geom_boxplot() +
#  # geom_text(aes(label = round(median(amount),2)), hjust = 0.5, vjust = -0.5, size = 8) +
#   scale_x_discrete(limits = c("Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag", "Sonntag")) +
#   theme(axis.text.x = element_text(size = 8),
#         axis.text.y = element_text(size = 8))
```


```{r}
run <- read_csv("runner.txt")
```


```{r}
run %>%
  ggplot(mapping = aes(x = "athlete's nationality",
                       y = time)) +
  geom_col() +
  theme_minimal()
```
```{r}
df <- swiss[c("Examination", "Education", "Infant.Mortality")]
#create a new dataframe. First column is "Examination", second "Education", last "Infant.Mortality".
df <- df[c(1, 2, 3, 10, 11, 12, 13),]
#create a new dataframe with the rows 1, 2, 3, 10, 11, 12, 13
```
```{r}
# Bar plot
df %>%
  ggplot(mapping = aes(y = "Infant.Mortality")) +
  geom_col() +
  theme_minimal()

```
position the caret at any line or the code chunk, then click "+".

The code chunk appears:
```{r}
```

Type any R code in the chunk, for example:
```{r}
mycars <- within(mtcars, { cyl <- ordered(cyl) })
mycars
```

Now, click the **Run** button on the chunk toolbar to [execute](https://www.jetbrains.com/help/pycharm/r-markdown.html#run-r-code) the chunk code. The result should be placed under the chunk.
Click the **Knit and Open Document** to build and preview an output.