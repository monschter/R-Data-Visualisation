---
title: "Jonis R Notebook"
output: html_document
---

The [R plugin](https://www.jetbrains.com/help/pycharm/r-plugin-support.html) for IntelliJ-based IDEs provides
handy capabilities to work with the [R Markdown](https://www.jetbrains.com/help/pycharm/r-markdown.html) files.
To [add](https://www.jetbrains.com/help/pycharm/r-markdown.html#add-code-chunk) a new R chunk,

```{r}
pacman::p_load(tidyverse, readxl, lubridate, RColorBrewer, ggthemes, unikn)
data <- read_csv("data.txt")
runner <- read_csv("../workout.csv")
# runner <- read_csv("dwr.csv")
# runner <- read.csv("dwr.csv", header = TRUE)

#runner <- fread("sed 's/\\0//g' dwr.csv")

# runner <- read.csv("dwr.csv", stringsAsFactors = FALSE)
# runner <- read.csv(file = "dwr.csv", sep = ";", header = TRUE)
# library(readr)
# runner <- read_csv(file = "dwr.csv", sep = ";", na.strings = "NULL", header = TRUE)
# runner <- read.table("workout.csv",
#                      header = FALSE,
#                      stringsAsFactors = FALSE,
#                      col.names = c("WorkoutStatistics", "startDate", "endDate", "sum", "unit"))
```

```{r}
# Transform the values in the date-column into a date format
#data$date <- as.Date( data$date, format = "%d.%m.%Y")

library(lubridate)
data$date <- parse_date_time(data$date, c("dmy"))
data$month <- parse_date_time(data$month, c("my"))
# Using functions provided by the `lubridate` -package, we transform the values in the month-columns into a date format:

data$weekday <- weekdays(data$date)

data$amount <- 1

#Using the `weekdays` -function we can add a column "weekday" that contains the day of the week corresponding to the date:
```

```{r}
data %>%
  ggplot(mapping = aes(x = month,
                       y = amount,
                        fill = weekday)) +
  labs(x = "month", y = "total amount") +
  geom_col() +
  theme_classic()
```


```{r}
#plot the amount of events per moth:
ggplot(data, aes(x=month, y=amount,fill=weekday)) +
  geom_bar(stat='identity') +
  xlab('Month') +
  ylab('Number of Events') +
  ggtitle('Number of Events Per Month')
```
(Language R)
given the following data frame called "data":
each line represents an amount.
The Column "date" contains the date of the month in a date format.
The Column "month" contains the month if the event in a date format.
The Column "weekday" contains the weekday of the event as a String.
weekday = {"Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag","Sonntag"}

plot the amount of events per weekday, fill = month. make sure that the x-achis is sorted.
add the median value of the amount to the plot. increase the text size on the x and y axis:

```{r}
data %>%
  ggplot(mapping = aes(x = weekday,
                       y = amount,
                       fill = month)) +
  labs(x = "weekady", y = "total amount") +
  geom_col() +
  theme_classic()


library(ggplot2)

ggplot(data, aes(x = weekday, y = amount, fill = month)) +
  geom_bar(stat = "identity") +
    theme(axis.text.x = element_text(size = 8),
          axis.text.y = element_text(size = 8))  +
  scale_x_discrete(limits = c("Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag", "Sonntag")) +
  geom_hline(aes(yintercept = median(amount)), color = "red")


# library(ggplot2)
#
# ggplot(data, aes(x=weekday, y=amount, fill=month)) +
#   geom_boxplot() +
#  # geom_text(aes(label = round(median(amount),2)), hjust = 0.5, vjust = -0.5, size = 8) +
#   scale_x_discrete(limits = c("Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag", "Sonntag")) +
#   theme(axis.text.x = element_text(size = 8),
#         axis.text.y = element_text(size = 8))
```


```{r}
run <- read_csv("runner.txt")
```

read distance 2
```{r}
# dwr <- read_csv(sep = ";", header = TRUE,"DistanceWalkingRunning2")
dwr <- read.csv("../workout.csv", sep=";")
distanceWalkingRunning4 <- read.csv("../dwr.csv", sep=";")
library(lubridate)

dwr$start <- as.Date(dwr$start, format="%Y-%m-%d %H:%M:%S %z")
distanceWalkingRunning4$startDate <- as.Date(distanceWalkingRunning4$startDate, format="%Y-%m-%d %H:%M:%S %z")
```

```{r}
dwr %>%
ggplot(mapping = aes(x = start,
                     y = value,
                     fill = unit)) +
  labs(x = "day", y = "distance") +
  geom_col() +
  theme_classic() +
  facet_wrap(~type,
             scale = "free")

dwr %>%
  ggplot(mapping = aes(x = start,
                       y = value,
                       fill = type)) +
  labs(x = "day", y = "distance") +
  geom_col() +
  theme_classic() +
  facet_wrap(~unit,
             scale = "free")
```


```{r}
distanceWalkingRunning4 %>%
  ggplot(mapping = aes(x = startDate,
                       y = sum,
                       fill = unit)) +
  labs(x = "day", y = "distance") +
  geom_col() +
  theme_classic() +
  facet_wrap(~type,
             scale = "free")

distanceWalkingRunning4 %>%
  ggplot(mapping = aes(x = startDate,
                       y = sum,
                       fill = type)) +
  labs(x = "day", y = "distance") +
  geom_col() +
  theme_classic() +
  facet_wrap(~unit,
             scale = "free")
```



```{r}
run %>%
  ggplot(mapping = aes(x = "athlete's nationality",
                       y = time)) +
  geom_col() +
  theme_minimal()
```
```{r}
df <- swiss[c("Examination", "Education", "Infant.Mortality")]
#create a new dataframe. First column is "Examination", second "Education", last "Infant.Mortality".
df <- df[c(1, 2, 3, 10, 11, 12, 13),]
#create a new dataframe with the rows 1, 2, 3, 10, 11, 12, 13
```
```{r}
# Bar plot
df %>%
  ggplot(mapping = aes(y = "Infant.Mortality")) +
  geom_col() +
  theme_minimal()

```
position the caret at any line or the code chunk, then click "+".

The code chunk appears:
```{r}
```

Type any R code in the chunk, for example:
```{r}
mycars <- within(mtcars, { cyl <- ordered(cyl) })
mycars
```

Now, click the **Run** button on the chunk toolbar to [execute](https://www.jetbrains.com/help/pycharm/r-markdown.html#run-r-code) the chunk code. The result should be placed under the chunk.
Click the **Knit and Open Document** to build and preview an output.